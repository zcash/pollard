use halo2::{arithmetic::Field, pasta::pallas};

use super::Spec;

/// Poseidon-128 using the $x^5$ S-box, with a width of 3 field elements, and an extra
/// partial round compared to the standard specification.
///
/// The standard specification for this set of parameters uses $R_F = 8, R_P = 57$. Having
/// an even number of partial rounds makes it easier to construct a Halo 2 circuit.
#[derive(Debug)]
pub struct OrchardNullifier;

impl Spec<pallas::Base> for OrchardNullifier {
    type State = [pallas::Base; 3];
    type Rate = [Option<pallas::Base>; 2];

    fn width() -> usize {
        3
    }

    fn full_rounds() -> usize {
        8
    }

    fn partial_rounds() -> usize {
        58
    }

    fn sbox(val: pallas::Base) -> pallas::Base {
        val.pow_vartime(&[5])
    }

    fn secure_mds(&self) -> usize {
        unimplemented!()
    }

    fn constants(&self) -> (Vec<Self::State>, Vec<Self::State>, Vec<Self::State>) {
        let round_constants = ROUND_CONSTANTS[..].to_vec();
        let mds = MDS[..].to_vec();
        let mds_inv = MDS_INV[..].to_vec();

        (round_constants, mds, mds_inv)
    }
}

// $ sage generate_parameters_grain.sage 1 0 255 3 8 58 0x40000000000000000000000000000000224698fc094cf91b992d30ed00000001
// Number of round constants: 198
// Round constants for GF(p):
const ROUND_CONSTANTS: [[pallas::Base; 3]; 66] = [
    [
        pallas::Base::from_raw([
            0x6190_4c05_11b7_37a4,
            0x37df_4021_c68b_5eef,
            0x21f1_0338_7216_cb91,
            0x2f2c_2bfb_d707_0f53,
        ]),
        pallas::Base::from_raw([
            0xfb31_1b7d_0f35_b058,
            0x3645_b63b_123b_613a,
            0x6ccd_d22b_2bbd_ead1,
            0x04ec_2fc5_c55d_6774,
        ]),
        pallas::Base::from_raw([
            0x6771_be5f_74ec_b0b6,
            0x63e4_6dfb_62f3_522b,
            0xfa9b_9241_2522_3a71,
            0x3c62_4cfc_4c99_4eb2,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x5a93_6dc4_5b05_9511,
            0xccec_d6c1_2a34_927a,
            0xdd9b_91a3_d903_1e29,
            0x3476_744a_626a_1813,
        ]),
        pallas::Base::from_raw([
            0x033e_60bd_7a63_cf16,
            0x4e4c_8c3f_df34_ea1a,
            0x09d3_b2dc_9dc0_7889,
            0x3e8e_3c1b_8e9f_1e18,
        ]),
        pallas::Base::from_raw([
            0x4be1_bb1b_9efd_907c,
            0x2af9_c485_bc73_d98a,
            0x247a_437c_362b_ba13,
            0x1439_f41a_f895_3e20,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x93ac_3d2c_a4ac_6c7a,
            0xaf57_eb31_28f8_6621,
            0xfea4_4f9f_1ee2_7531,
            0x2184_e123_d6f4_e5e9,
        ]),
        pallas::Base::from_raw([
            0xa3ed_a4c8_1672_9416,
            0xf8e0_5b92_93c9_b396,
            0x8cc0_34f5_68ae_dbe1,
            0x3310_19b9_09d6_c87d,
        ]),
        pallas::Base::from_raw([
            0xa53f_26c9_a84f_a24e,
            0xd1eb_a258_6b77_9d45,
            0xc6ec_9cff_8656_ad7e,
            0x0007_8b16_de3f_a3a0,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x5bc1_b292_6f39_601e,
            0x8578_2423_cf7f_d130,
            0x1d44_ff02_4f9f_4e7a,
            0x394f_7421_1753_9cad,
        ]),
        pallas::Base::from_raw([
            0x8ed5_76fd_4d43_d779,
            0x0311_e30e_0ba5_c300,
            0x6e65_df29_3f27_25e0,
            0x261e_237d_617e_261a,
        ]),
        pallas::Base::from_raw([
            0x4513_b401_f48a_3668,
            0x857d_2f7b_4075_d28b,
            0x33dc_cb6f_7c44_8319,
            0x252d_1389_b3ae_fdd2,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0xf69d_f9e7_88a5_fe24,
            0x38d6_3539_2451_923a,
            0x67bf_7e43_0350_923d,
            0x025c_a9dd_a3db_70df,
        ]),
        pallas::Base::from_raw([
            0xc18c_1272_2350_1f93,
            0x8d15_2f5c_9542_1ab6,
            0x17e5_17ed_d753_f0b1,
            0x1d2c_2ace_140a_d5b6,
        ]),
        pallas::Base::from_raw([
            0x6768_c840_3f50_ac2c,
            0x4079_eb21_f42e_4af0,
            0x654c_7abd_86a6_8443,
            0x0ba4_95c1_f7b7_7dbf,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0xd8af_6070_2eef_9e28,
            0x05f1_5752_efc3_ebe1,
            0x5bb2_f866_4192_2732,
            0x2cbc_e449_5032_4cba,
        ]),
        pallas::Base::from_raw([
            0x671a_fb22_aeae_9d14,
            0xfe5e_302a_8a71_c31c,
            0x95e4_242d_b16d_3a33,
            0x2476_7e0d_3abf_426d,
        ]),
        pallas::Base::from_raw([
            0x0d92_8670_de2a_3031,
            0xb8a9_71e0_ba9d_aab5,
            0x146d_53fc_c83a_ea81,
            0x1acd_6ef0_e60e_4b14,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0xcc1c_8611_4da6_a1eb,
            0xa17e_77a8_a72e_7eed,
            0x1994_2055_672d_627d,
            0x340f_94d4_00bd_0a31,
        ]),
        pallas::Base::from_raw([
            0xd51e_2326_061e_22c0,
            0x472c_8da2_9209_c94d,
            0xd607_11e3_3e0c_6b82,
            0x0327_373c_ca3d_d2f8,
        ]),
        pallas::Base::from_raw([
            0x5fdb_2ffc_f016_1350,
            0x39ee_1819_0c5c_2080,
            0x17c2_d6ae_0490_61e9,
            0x1d10_41d8_2c9d_480f,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x51bc_3143_6ab5_a574,
            0xb7d1_3550_1d3d_911f,
            0x895e_8c73_6110_59f8,
            0x0de4_750f_968b_5257,
        ]),
        pallas::Base::from_raw([
            0xb241_4383_ee1a_5794,
            0x1145_4b0c_d0eb_7d3f,
            0xc7fc_9a99_c916_ccba,
            0x3592_90a3_7861_96bb,
        ]),
        pallas::Base::from_raw([
            0x18c2_0b5c_ec2e_8036,
            0xdd44_60b6_7aef_0364,
            0xba58_0e14_53f3_094d,
            0x28ff_cddd_f417_cbab,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x322d_2c6a_faab_6a00,
            0x8601_0174_246d_3c89,
            0xde99_a4e4_dcc1_3084,
            0x0e76_c3df_688e_d3f5,
        ]),
        pallas::Base::from_raw([
            0x7892_2912_d57f_57c7,
            0x7c42_ac6e_80e9_7c5b,
            0xbde1_8a6b_3a19_c2ef,
            0x172c_a76a_f974_367a,
        ]),
        pallas::Base::from_raw([
            0x9b64_fa4d_c692_195f,
            0x8951_a840_7b00_fd3f,
            0x6626_01e1_68f1_a7aa,
            0x12ed_4668_b154_3521,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x90f2_a829_e538_d398,
            0x2f61_4f7b_cf82_32ef,
            0x6fd7_211f_8354_d509,
            0x0c2e_a06a_9894_cea5,
        ]),
        pallas::Base::from_raw([
            0x7c7f_ea10_9bb0_9622,
            0xb55d_8ea1_3054_9451,
            0xe547_5968_9b03_8ae3,
            0x0fae_a603_1813_6b64,
        ]),
        pallas::Base::from_raw([
            0x287b_fe86_a1e6_6b27,
            0x1e7b_9009_8c78_a371,
            0xb93e_ebf4_dd9a_414f,
            0x1bea_eb46_5cd4_c711,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0xa81a_dd76_cd42_a4e3,
            0x3b6f_7bdd_6b37_dd97,
            0x2c2b_06ed_e811_4d46,
            0x351c_94b9_bcca_5b1a,
        ]),
        pallas::Base::from_raw([
            0xdcfc_4eba_a75a_4d92,
            0xbb6e_d62b_9232_8294,
            0xe68f_84dc_f259_a459,
            0x2a18_38fa_c174_9e4f,
        ]),
        pallas::Base::from_raw([
            0xcd23_0bfa_e2f6_70fb,
            0x9341_8cf0_2a66_ea98,
            0xa4f8_8c06_ea9c_2ab8,
            0x3f87_5c2c_d7e1_d69e,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x6ce2_37b7_c99f_07a1,
            0x0ddd_35b2_87fd_c798,
            0x145f_e811_a3fc_4486,
            0x3122_4a34_1252_9b86,
        ]),
        pallas::Base::from_raw([
            0x615b_6db2_9fd9_314e,
            0x0d6e_e24b_4e39_c55c,
            0xb42a_1119_bfba_e23e,
            0x1556_b2b9_633a_e623,
        ]),
        pallas::Base::from_raw([
            0x7522_5cd9_ed99_f2c2,
            0x6aff_3ab0_3e93_5519,
            0x1ce8_ca1c_71e5_fb34,
            0x399b_acd8_f54c_cc4d,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0xf2f0_997b_bbaf_80e3,
            0x31c4_3e3a_d4d2_0eba,
            0xa02d_7dab_c144_4ad1,
            0x3898_7736_8a5c_321e,
        ]),
        pallas::Base::from_raw([
            0xaebc_66a5_0a73_b506,
            0x6f78_fa39_361a_74cc,
            0xc6d1_7e9a_4132_067f,
            0x0ef3_2660_7429_91bb,
        ]),
        pallas::Base::from_raw([
            0x6d97_adb2_c113_9c94,
            0xfb7a_99f0_1266_cbe8,
            0x6eb3_d15a_465c_9221,
            0x1e49_1a5f_dda8_24e2,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0xa07d_60fa_fe7f_0aa7,
            0xc6ad_0f62_f313_97e8,
            0x6ae7_ab72_cc34_eb48,
            0x2de4_d6ff_6ff2_634b,
        ]),
        pallas::Base::from_raw([
            0x06db_ddfc_dba5_2766,
            0xbf31_9eac_78d2_c935,
            0xf2a5_b561_38dd_2a5b,
            0x1283_a380_05b8_f0a7,
        ]),
        pallas::Base::from_raw([
            0xdf23_b7b3_98f0_61b6,
            0xb3c9_1a96_0025_c6ac,
            0xe092_ca71_681d_8050,
            0x19e2_efea_5020_aa4b,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x0b7f_4824_8fec_885d,
            0x6109_68a1_4a94_ce03,
            0xf557_19af_51c1_1b6b,
            0x287f_b567_ece3_5108,
        ]),
        pallas::Base::from_raw([
            0x5980_0355_f507_bb83,
            0x587f_25e1_e974_432d,
            0x5202_d448_3f10_d32a,
            0x2761_ea58_6e5d_500d,
        ]),
        pallas::Base::from_raw([
            0x6d52_9cb3_1dff_100e,
            0xf85d_7939_79ae_02c4,
            0xaf18_b1bd_8786_f740,
            0x2f77_d7a4_f74d_b35e,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0xd34b_6824_5ebf_1dc2,
            0x3200_eb32_4f5d_7c33,
            0x0d4a_5e12_0b9d_c8f1,
            0x0390_862d_7e6e_7a69,
        ]),
        pallas::Base::from_raw([
            0x352e_4174_565c_5a52,
            0xd519_6ea5_d70b_bdb6,
            0x8c2a_51c1_1a9c_c97f,
            0x14d5_b21d_a4b4_5c80,
        ]),
        pallas::Base::from_raw([
            0x3f85_66c9_d7d1_e755,
            0xacb7_96e3_1fc8_737f,
            0xd088_112a_1784_03a1,
            0x2974_ad78_ec5d_90fb,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0xffb5_3b78_5334_ee3c,
            0x28b4_13c7_a3bb_7e68,
            0xa3a1_c290_f0b0_4b7a,
            0x36b5_8f70_52ad_cc1f,
        ]),
        pallas::Base::from_raw([
            0x9715_9cc8_a973_39c2,
            0x19c4_993e_b1fd_95ae,
            0xaeb8_7009_3f64_3639,
            0x2efb_0a9e_fd6c_60a1,
        ]),
        pallas::Base::from_raw([
            0x29b6_1e80_5c98_c1ff,
            0xd152_8ff7_aa4b_b022,
            0x3f19_a23c_72a2_a102,
            0x1f04_ae7d_f249_c70c,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x1363_315c_4d8e_0cb0,
            0x91fd_0d3b_8c61_7d8a,
            0x5964_2e54_f819_8589,
            0x278d_44fe_8f8c_2996,
        ]),
        pallas::Base::from_raw([
            0xe334_4dc1_c159_2406,
            0x6ded_5b7f_8cef_c2a2,
            0x49b4_5714_ae1b_0f6a,
            0x1a2b_bd02_2168_061c,
        ]),
        pallas::Base::from_raw([
            0x13eb_f947_a355_9f9c,
            0xf93c_b4ed_2236_6398,
            0xdf8a_91de_8e68_8793,
            0x0f0d_e2f7_3193_a97e,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x0072_ef68_ea43_8f92,
            0xb76c_d699_d0b3_0adf,
            0x5092_c3d2_32a0_9399,
            0x3ac4_7dc2_48f1_6ac5,
        ]),
        pallas::Base::from_raw([
            0xb3c7_7965_3e34_a054,
            0x002c_2347_a222_043c,
            0xf4a0_c967_5981_2f90,
            0x1f7f_927d_aef5_fc95,
        ]),
        pallas::Base::from_raw([
            0xc0b1_79e1_cc95_0b85,
            0x945c_315c_e93d_fc00,
            0xe6e3_cd02_b1ad_cb7c,
            0x250b_4faf_86d7_2618,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x65d2_0118_981a_de0e,
            0x7288_bcc4_fab6_750d,
            0x6252_8967_df12_153f,
            0x07c6_4646_dee2_604b,
        ]),
        pallas::Base::from_raw([
            0xee93_af96_dbad_ff1d,
            0xa05c_8ca1_dd71_32ef,
            0x78fa_143c_a115_8bbb,
            0x24cb_bd23_4c0e_f700,
        ]),
        pallas::Base::from_raw([
            0x54bb_4e6c_f7fa_521b,
            0xc536_2d39_b634_8ecc,
            0xfdbb_f3cc_08b7_adec,
            0x208e_df94_ef33_9a27,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0xf96c_7fd8_2a46_da35,
            0xf45f_1196_3d6c_1806,
            0x0a58_9d3d_2c4d_14db,
            0x3ea2_a73f_40f1_f3d2,
        ]),
        pallas::Base::from_raw([
            0x5973_a73e_a275_2c7a,
            0xe79c_b26f_f91b_9be1,
            0x771b_b857_f4c5_1f58,
            0x36cc_b856_7075_d3a0,
        ]),
        pallas::Base::from_raw([
            0xfc86_81d1_7000_408c,
            0x3adc_95de_617c_fa32,
            0xa9cd_f91c_e7f8_3147,
            0x0865_4b64_9a50_91ba,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0xa989_8bed_507f_18ea,
            0xa5fa_c865_c5b6_ee7d,
            0xf28b_308e_e52a_8e0e,
            0x2b58_a76b_cbfb_8500,
        ]),
        pallas::Base::from_raw([
            0x7d15_8962_25d5_9a2e,
            0xe2ed_8f25_33be_8e73,
            0x4614_b661_05cc_b699,
            0x1001_d34a_284e_2b25,
        ]),
        pallas::Base::from_raw([
            0x9c42_86cc_6354_bc9c,
            0x2a61_dece_93b1_651c,
            0x2f1e_63d2_30af_a70c,
            0x1337_5ab0_b535_0afb,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x5622_b222_a0f0_aacb,
            0xac5b_9ccb_5216_abda,
            0xec72_491a_04c6_4702,
            0x2a71_69d4_6ff2_ffba,
        ]),
        pallas::Base::from_raw([
            0x55ea_ce8b_6210_1ae0,
            0x51d2_1417_4045_e6fc,
            0x9860_9472_4c18_52f6,
            0x033e_b55b_edfd_6b29,
        ]),
        pallas::Base::from_raw([
            0x5ec0_5387_9568_fad1,
            0x795c_7f74_d5d1_c53b,
            0x19e3_1226_ee75_1c71,
            0x10ca_1ffa_2026_0f40,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0xf1f0_9804_30bd_6854,
            0x495d_5082_cf47_489d,
            0xe461_72c4_2bbc_83e3,
            0x06c1_da78_f2f5_f0fd,
        ]),
        pallas::Base::from_raw([
            0xf74a_4bab_5a21_c53f,
            0x3b4e_83b5_09a3_975c,
            0xfdd8_999c_5424_4724,
            0x1ae9_bf00_85d1_a2b7,
        ]),
        pallas::Base::from_raw([
            0xcbdb_eb71_eec5_383c,
            0xd38b_e406_010a_91c1,
            0x0754_2c63_1e00_2e81,
            0x3685_99e0_cc70_9b2d,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x2278_8138_e958_4f32,
            0x898f_3267_9397_2442,
            0x2e02_d60c_365d_cb49,
            0x02e7_9429_cc4d_4a36,
        ]),
        pallas::Base::from_raw([
            0xa0a8_2bd6_1d49_d14d,
            0x4a43_15eb_87d9_9b67,
            0x00d3_998a_d9c2_20db,
            0x18c5_41e9_d275_1b80,
        ]),
        pallas::Base::from_raw([
            0x01c9_bf57_9600_678e,
            0x4474_43b5_f9d9_292b,
            0xb49b_9fb5_4a89_a586,
            0x1975_07d5_e313_e2e3,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0xbffc_4f5f_ddbd_c07f,
            0x6f47_0f70_41be_91ab,
            0x6696_164e_25e7_0092,
            0x26b1_bd92_ee89_3188,
        ]),
        pallas::Base::from_raw([
            0x4d8c_ad71_a7e5_fdbe,
            0x2681_d0a2_3a45_7772,
            0x98d8_f8f4_4dea_ed09,
            0x0efd_b615_f564_ee46,
        ]),
        pallas::Base::from_raw([
            0x6814_4a5f_c771_da1c,
            0xac9f_2bcc_f1fa_8d43,
            0x7a71_bdbe_3259_4a48,
            0x266a_5ddd_c5f8_3288,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0xb32a_9caa_f616_8330,
            0xb575_fb42_0a34_4f56,
            0xe17d_8e2d_f091_7f29,
            0x34f3_56e3_badb_42d5,
        ]),
        pallas::Base::from_raw([
            0x258b_3a63_f45e_bcaf,
            0xf138_f015_bc0d_0d5a,
            0xddd7_16c5_b3f0_4c48,
            0x2fa9_ad6f_882f_66cc,
        ]),
        pallas::Base::from_raw([
            0xb2ab_8c35_890d_cd99,
            0x7350_958a_ac95_be44,
            0x84f4_fc53_939b_ed4d,
            0x210b_6333_86cd_d227,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0xd6a5_6d62_f6ad_9eb3,
            0x0937_f9d6_cf91_437d,
            0x4e80_ab16_39af_af61,
            0x34dc_0f06_9165_b00e,
        ]),
        pallas::Base::from_raw([
            0x3326_b045_5cf8_778c,
            0x913f_a6f4_11c7_dc73,
            0x82d0_614a_e013_d8c7,
            0x259b_4cb0_b086_1d07,
        ]),
        pallas::Base::from_raw([
            0xa7d0_770e_ad39_5746,
            0x315a_baf4_89d4_1b29,
            0xc660_788b_3e78_bd62,
            0x0f88_d8b6_c5d9_073d,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x2084_d439_504c_1fc6,
            0x3282_e45a_f42d_83c7,
            0x5bae_f3db_5d93_3785,
            0x30ab_d11e_cb73_119f,
        ]),
        pallas::Base::from_raw([
            0x63a1_8839_c6f6_446f,
            0x5efc_980a_bba7_cc33,
            0xf302_af09_d5ba_ec04,
            0x3152_ce32_5264_529c,
        ]),
        pallas::Base::from_raw([
            0x34f7_c161_3c27_0e35,
            0xe295_4fc5_9859_ff6c,
            0xbe94_978e_ddc4_51ed,
            0x00bd_3146_554e_552a,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0xb7f2_4921_d8d4_a0fe,
            0x15a9_3afa_e282_c149,
            0xee1c_ea96_ee50_9228,
            0x2c1e_f4c8_ef91_1a32,
        ]),
        pallas::Base::from_raw([
            0x3296_6e61_c7ad_12b3,
            0xbdd8_bc44_6d7b_ebcd,
            0x2972_1a01_deb5_335b,
            0x2386_9adb_5876_af5f,
        ]),
        pallas::Base::from_raw([
            0xe2ea_4991_a83e_5559,
            0xf372_cb64_c6be_d49d,
            0xaccd_f61a_c128_cb35,
            0x2af8_8e26_1ca1_217c,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x80c9_c434_914c_b08a,
            0xa40d_cea8_f7f0_97f1,
            0xa257_ecf1_0b3d_aaf6,
            0x1b5d_76d6_c03d_a588,
        ]),
        pallas::Base::from_raw([
            0x37d0_8e8f_023b_6285,
            0xfe59_9fc4_7620_2d0a,
            0xcfc6_bd3d_2f02_7c3a,
            0x1c76_daae_2af0_990f,
        ]),
        pallas::Base::from_raw([
            0xb85e_a92c_8328_797f,
            0x59e5_b761_f252_18ad,
            0x3bbb_3577_ca09_d9f0,
            0x2f58_93f6_a6e2_ef3d,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x1833_029f_7309_4c23,
            0x3327_8958_6064_7230,
            0xe894_488c_79ff_5370,
            0x1a11_a3dc_1687_4116,
        ]),
        pallas::Base::from_raw([
            0xf7c9_a6bd_81c2_000e,
            0xcde0_6b75_292c_4777,
            0xed91_4926_1eac_2db8,
            0x22b2_a9a8_4c55_5a46,
        ]),
        pallas::Base::from_raw([
            0x9339_8ca5_a5e8_bbaa,
            0x6f6f_9834_8d77_c85b,
            0x7220_4d8f_5e4e_e22e,
            0x1f72_01ee_4928_76c1,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0xf636_c50c_f6fd_d861,
            0x211e_ab31_8f41_42dc,
            0x2512_ee31_1910_c8f8,
            0x08e2_edc6_fbdc_691f,
        ]),
        pallas::Base::from_raw([
            0x03df_22f7_61e0_6616,
            0xdf0a_181b_9932_2307,
            0xb250_c657_8359_c6a4,
            0x1737_26c1_c53a_38ab,
        ]),
        pallas::Base::from_raw([
            0x8958_0351_e387_8456,
            0x729a_8410_c1e2_5489,
            0x7d1e_d330_1929_1435,
            0x2ffe_9110_497c_dee2,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x8de1_001e_d1cc_4478,
            0xe4fd_5bd6_5a73_8f7f,
            0xdad1_5fb8_6a62_79d9,
            0x02f1_f990_3714_8d41,
        ]),
        pallas::Base::from_raw([
            0x86b3_f413_408e_73c7,
            0x97d0_126d_c4eb_15da,
            0xf04a_f6cf_b2e6_f0a8,
            0x0a2c_4dbf_4da2_980e,
        ]),
        pallas::Base::from_raw([
            0x363c_f0c6_1f2b_c143,
            0x14fa_3c81_edcf_cf8d,
            0x7913_597b_d93b_e23a,
            0x2970_b9d6_3a8d_b924,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x771e_d118_571f_65c1,
            0xde9a_8b95_5210_901a,
            0x69a2_bf80_aa73_8769,
            0x0400_e593_87ee_438d,
        ]),
        pallas::Base::from_raw([
            0x2a61_3b39_9eef_6665,
            0xdad6_b1ac_8ec6_fe11,
            0xbc61_4b93_8890_be42,
            0x25be_6a88_f910_a398,
        ]),
        pallas::Base::from_raw([
            0x6b72_9a6a_5fc8_9279,
            0xad74_ca8b_334d_c53a,
            0x4899_d113_fc17_41fb,
            0x03ea_4bdf_101f_d934,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x4141_8934_d16f_1c4f,
            0xd307_7303_195f_57fc,
            0x9b21_8f28_2aa1_c2df,
            0x1047_fad9_b32e_fea0,
        ]),
        pallas::Base::from_raw([
            0x3421_74c0_8f0e_99ac,
            0xcc6a_a4c2_a2de_1b55,
            0xf6ff_cf3f_7dde_261c,
            0x0a87_65e8_2791_f0fa,
        ]),
        pallas::Base::from_raw([
            0xf589_8f39_574e_3d46,
            0xc6a1_dde0_8c7d_f91d,
            0x43fd_78b1_caa0_1bc4,
            0x2326_fa25_a0eb_dced,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x9dec_33c3_a37a_4a02,
            0x63c4_69e9_8f0e_7f42,
            0x32ab_8d8e_f1cc_c268,
            0x1b1a_9c59_6960_3195,
        ]),
        pallas::Base::from_raw([
            0x0c21_ae5e_15d6_dcf4,
            0x36c0_68f6_550f_fea1,
            0x9eaa_5f9a_cf0a_4809,
            0x3b29_8d20_b110_0560,
        ]),
        pallas::Base::from_raw([
            0xa7c8_70bb_6170_25f3,
            0xaaca_4d92_4128_005e,
            0x488a_42e8_d5f2_6f94,
            0x1577_6a39_3f3d_75ee,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x27d1_9784_5e9b_8bff,
            0x70ce_cf5a_6a12_220e,
            0xac0c_f2e2_d173_cedf,
            0x062e_8dab_4d23_7e8a,
        ]),
        pallas::Base::from_raw([
            0x2920_36c7_10a4_89b7,
            0xf685_88e8_f5e4_2277,
            0x510c_c767_0229_45e2,
            0x0071_9d1b_34cd_a84f,
        ]),
        pallas::Base::from_raw([
            0x34bd_dbb6_7246_7d41,
            0xf19e_59a3_cb71_50c4,
            0x2f17_92c3_e496_c93a,
            0x0f90_1761_fa7e_0016,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x6026_4363_487f_e0c4,
            0x8870_5c97_60c5_8f32,
            0x3f76_9a14_a7c3_d54f,
            0x18f3_9bd0_2bcc_22f4,
        ]),
        pallas::Base::from_raw([
            0x0820_60d5_bef3_2e60,
            0xc25d_0428_0d69_a9bb,
            0xee60_341f_3c2f_281f,
            0x1676_0882_4f7f_125f,
        ]),
        pallas::Base::from_raw([
            0x8ba0_a876_454c_3de2,
            0xa5bf_90ea_ab88_e716,
            0xd8ea_a882_40f1_c586,
            0x2f9d_3358_af7e_3bcf,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x079d_6a3f_ebcf_9e3b,
            0x6adc_6096_c706_e318,
            0x18a6_9f25_2ba9_c513,
            0x32ac_45a3_7e16_86ae,
        ]),
        pallas::Base::from_raw([
            0x55cc_d0c3_22d7_de32,
            0xebae_5321_2e62_9d33,
            0x113d_cb80_a1fa_1bd8,
            0x2f89_51ae_3f28_9d7e,
        ]),
        pallas::Base::from_raw([
            0xef6d_d647_040a_65fe,
            0x8673_f223_5a4e_fc40,
            0x92dc_e5f8_9ae2_377c,
            0x33a9_c0aa_4190_b15f,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x98e8_14d2_8ef6_8fc0,
            0x4f67_12f0_7f43_ad5d,
            0x5378_dd6e_e7ee_0e55,
            0x16dc_7bbb_45d7_3243,
        ]),
        pallas::Base::from_raw([
            0x06b0_16f2_516b_9ff7,
            0x14b6_94d3_a60b_6d61,
            0xa2dc_781f_dc4b_9352,
            0x2859_b4d0_a15a_bff3,
        ]),
        pallas::Base::from_raw([
            0x32c2_7f4c_f838_4cb1,
            0x9607_c6db_a3dc_47ec,
            0x0676_1253_e857_b217,
            0x291e_7534_b1ac_0d44,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x9bce_91ae_f428_bf67,
            0xafca_dfe2_06a9_a114,
            0x23ce_32f9_566f_0613,
            0x25ca_b061_3937_bf2c,
        ]),
        pallas::Base::from_raw([
            0x9311_9a37_cf39_651d,
            0x9dab_05fe_f552_1021,
            0xf333_1b3d_67b4_1c7b,
            0x05d7_5d4b_a225_bd59,
        ]),
        pallas::Base::from_raw([
            0x6c42_80c5_c8ff_fdb2,
            0xdd1b_0de4_9f51_890f,
            0x97fd_3b92_5c1c_b260,
            0x08f1_ac49_2aea_eb40,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x6d42_0f57_bbac_4a5c,
            0xfb0f_b949_8581_ea28,
            0x797e_85bd_e05f_be51,
            0x1930_f19b_b316_2224,
        ]),
        pallas::Base::from_raw([
            0xbf01_921c_5018_7dad,
            0xe36b_4db7_d6d3_cf54,
            0xaacf_abdf_761a_c8db,
            0x3097_6bf9_c5ba_0385,
        ]),
        pallas::Base::from_raw([
            0xc750_da24_f295_7c5d,
            0xdfec_ea86_51ec_61a4,
            0x3d0b_cdfa_a7bc_e677,
            0x2456_5e3c_889e_675e,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x4c06_88bb_35b4_a84d,
            0x0ebb_63d1_313e_6f41,
            0xe94f_3558_cc6e_f85b,
            0x1b49_63d6_634d_1aa4,
        ]),
        pallas::Base::from_raw([
            0xd8b8_55e1_fec7_601c,
            0x102a_81c5_2750_19fe,
            0x861b_3c28_1de8_8796,
            0x11c6_3172_26eb_efe1,
        ]),
        pallas::Base::from_raw([
            0xe03f_84aa_7a81_2b35,
            0xfdd4_4941_11f5_2a2f,
            0xd729_b7ac_24f7_5e3e,
            0x31e4_caa7_2b12_8088,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0xf796_00fa_0211_a509,
            0x9d78_c4f1_d61a_6d01,
            0x5d3d_0534_c8f6_53c5,
            0x28f0_c2c9_dc75_d859,
        ]),
        pallas::Base::from_raw([
            0x9c6f_63ff_9ba1_a43d,
            0xc589_d66d_722f_1117,
            0x1793_ba72_151e_d438,
            0x2d2e_d9e6_5605_3773,
        ]),
        pallas::Base::from_raw([
            0xdb98_8598_2dec_47a0,
            0x2e8d_9047_e90b_4a36,
            0xf739_aa08_c198_63ec,
            0x2d82_d12d_5502_c57e,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x37e0_4c12_3560_7016,
            0x1695_e6fe_0408_ed4c,
            0xa37b_3550_d9e2_09e0,
            0x37ca_6631_22f8_f8c3,
        ]),
        pallas::Base::from_raw([
            0x7522_9991_9a06_4262,
            0x9e41_f1f9_8fdd_90e8,
            0xfdaa_11f4_48aa_594e,
            0x23ae_a613_927e_92f3,
        ]),
        pallas::Base::from_raw([
            0xef5f_02a7_ddca_9494,
            0x24e6_f954_57b7_ea81,
            0x10a8_afcd_345d_4e12,
            0x35a3_2d06_4403_f6c2,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x3a1c_403f_5374_09db,
            0x4dd8_9298_011e_5096,
            0x066f_e616_175c_bc52,
            0x10dd_3772_c90d_fb82,
        ]),
        pallas::Base::from_raw([
            0x3e11_d8ae_b0ac_e075,
            0xf477_c341_db2d_e6a3,
            0x3b28_c529_02a5_dee5,
            0x1688_8fc7_3063_7975,
        ]),
        pallas::Base::from_raw([
            0xf561_d150_c731_3263,
            0x6ec5_9705_0032_a368,
            0x1985_97ef_a84f_66ef,
            0x1574_87d3_6ab5_b7c6,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x6227_c476_ee63_9d21,
            0x0962_5055_fe9b_cb61,
            0xa8a2_3d89_03f5_c745,
            0x09db_6859_5b17_923b,
        ]),
        pallas::Base::from_raw([
            0x4f6b_b0bb_7401_31bf,
            0x6d78_5da5_91fe_7104,
            0x2b15_4413_1870_8c59,
            0x2680_93fe_30f1_7639,
        ]),
        pallas::Base::from_raw([
            0x5f53_1cd3_7695_3963,
            0xc123_c2bc_f66e_ae25,
            0x527b_cdc5_78ee_c161,
            0x2bcd_beb2_8b4a_ce35,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0xde61_92fa_1a74_57e0,
            0xfbe3_9694_bb5b_b4e4,
            0x12d1_af8b_0008_b7ba,
            0x15fb_7e0b_adca_6d87,
        ]),
        pallas::Base::from_raw([
            0xb972_bf42_4ec6_a34d,
            0x9429_9bb9_6375_61d9,
            0x7986_e17f_6624_63d0,
            0x17bc_5b91_ab0d_42c9,
        ]),
        pallas::Base::from_raw([
            0xb906_b04d_f55e_3332,
            0xc5bf_ef2c_af73_a21b,
            0xfbad_933f_9509_769a,
            0x28ba_3b75_2ddd_1219,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0xc2f3_a535_2ba0_a6a6,
            0x7738_3c76_6143_4bc7,
            0x3a9e_9daf_6c26_4cd4,
            0x08c2_1be5_da07_97c9,
        ]),
        pallas::Base::from_raw([
            0xf20f_0093_dd5b_fa1d,
            0x200f_12f5_2298_0391,
            0x5da1_a907_b0f3_d71e,
            0x1368_f9ec_d178_721b,
        ]),
        pallas::Base::from_raw([
            0xaa33_8c85_9817_0874,
            0xa612_4eae_2327_67d0,
            0x1181_6d40_2f28_6afb,
            0x3964_8728_08c6_0d5e,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x4719_a8ea_4c4d_7c8b,
            0xafe8_5e7f_f470_8b5a,
            0x4394_a51f_e439_9eab,
            0x1980_d806_4cb2_b405,
        ]),
        pallas::Base::from_raw([
            0xa4da_cee9_bba1_8392,
            0xe92d_094a_07af_1dc5,
            0xe084_68fe_ea77_7763,
            0x17d3_146d_fdcc_73a6,
        ]),
        pallas::Base::from_raw([
            0x5192_9aae_aa1f_059f,
            0xc7ba_5faf_4b62_4660,
            0x7f51_a976_8d9b_1016,
            0x096d_d279_5c02_3850,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x905f_7653_4b6e_4d0b,
            0x0eda_2f75_5fab_8728,
            0x5171_5eb6_5d21_3af1,
            0x253d_45b9_f0ba_5d8e,
        ]),
        pallas::Base::from_raw([
            0x49d0_fcad_93df_0814,
            0x659a_2a33_fe85_7c5b,
            0x7dfe_6b82_afaa_9233,
            0x0c43_204d_8daf_1fcf,
        ]),
        pallas::Base::from_raw([
            0x9164_030f_84f4_f704,
            0xda9d_65a8_7f26_2736,
            0xfe24_af67_14ff_5ac1,
            0x1c89_6e0a_96d7_fd26,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0xa7b9_e183_34de_48b9,
            0x7192_7b6a_f97f_22e6,
            0xd478_9b02_f826_e556,
            0x2940_86bc_2cea_0bc9,
        ]),
        pallas::Base::from_raw([
            0x669f_abec_34df_de7d,
            0x2085_c987_b907_ed49,
            0xf65a_d183_8207_d907,
            0x23e4_09c4_60e1_df98,
        ]),
        pallas::Base::from_raw([
            0xbe71_f83c_2a4c_3aa6,
            0xb7d6_fac1_e548_3f42,
            0x5389_2fdc_8946_d032,
            0x0474_f595_87e5_2aba,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0xa236_8fb2_845c_0058,
            0xf86d_966d_8587_3a5e,
            0xa1dd_59a9_b58b_11aa,
            0x3cba_f270_4083_7d2e,
        ]),
        pallas::Base::from_raw([
            0x0226_357c_51d8_caa9,
            0x1253_2d7c_27d8_65c2,
            0x9688_c024_75cd_de18,
            0x363f_69f6_1694_ce23,
        ]),
        pallas::Base::from_raw([
            0xbd6d_470d_0b0e_aba9,
            0x2e97_3761_7d4c_6d77,
            0xa146_92c5_8aab_7b8e,
            0x1a19_06f6_e694_8159,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0xb135_24a8_8911_89e2,
            0x474d_ac9e_a941_3da7,
            0x9ea3_aae5_37dc_9f49,
            0x3f55_112d_29d0_cd0a,
        ]),
        pallas::Base::from_raw([
            0xa02d_d716_8474_ccde,
            0xf438_b525_608a_c8bb,
            0xba15_b594_7c45_bda8,
            0x35ac_2c37_ec04_5706,
        ]),
        pallas::Base::from_raw([
            0x6b8b_23f3_94c3_31eb,
            0x7825_dc7a_2f52_dffe,
            0x43d4_a724_cc4d_ef7f,
            0x0c76_87e1_da1a_9ab9,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x0575_84c0_0e38_21cb,
            0xafca_04fe_e1d6_26b4,
            0x75d5_4080_f03e_1f99,
            0x05e9_8545_421d_5e76,
        ]),
        pallas::Base::from_raw([
            0xd9b7_8df9_79c1_37ac,
            0x9262_85b8_6c63_187c,
            0x9a0e_e226_7846_93fb,
            0x2e0b_8eaa_fcab_9b61,
        ]),
        pallas::Base::from_raw([
            0x9607_aa13_ed44_daf0,
            0xd35b_9e4f_a399_9a6a,
            0x273c_7823_c42d_ccc2,
            0x05c7_6e87_1214_1f4a,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x8b2a_481c_56ba_9c0c,
            0x3a17_a833_b534_d6fe,
            0xea06_940b_e2c6_34d6,
            0x2fa7_be72_d067_2174,
        ]),
        pallas::Base::from_raw([
            0x6f78_11f5_054c_dbde,
            0x1210_de57_4d4c_2fee,
            0x6499_dfa3_70c1_28a8,
            0x0fb7_6439_1393_5067,
        ]),
        pallas::Base::from_raw([
            0x596e_2345_784f_68d0,
            0xebd3_f445_5a24_36ce,
            0x8fa4_69f9_6a5c_0dc1,
            0x25ad_36d3_824b_9c3c,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x5c02_32e3_bcd8_6646,
            0x876f_6a03_f6d1_4fc7,
            0x1019_fef5_8cc7_0312,
            0x2ea6_1863_5d2a_84e3,
        ]),
        pallas::Base::from_raw([
            0xd5f1_76c6_2846_4f21,
            0x1286_8044_b458_cb5a,
            0xc04d_e2d4_8886_b1b8,
            0x0a93_3a76_9974_6381,
        ]),
        pallas::Base::from_raw([
            0x4313_1bac_cc08_b134,
            0x06ed_f6fc_efd1_3481,
            0x338b_6074_9293_22b4,
            0x1fc6_239c_bbc2_9822,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0xb3a1_1859_ee5f_d06c,
            0x337f_fca1_97d0_2ef3,
            0x86cb_2037_12db_7076,
            0x193c_32e1_33cf_528a,
        ]),
        pallas::Base::from_raw([
            0xfc21_f046_34ea_4f51,
            0x253c_589f_5e75_5dac,
            0x2836_75b5_2631_2a9c,
            0x30d5_c435_da0e_541f,
        ]),
        pallas::Base::from_raw([
            0xee16_fd3a_6ae7_5a8a,
            0x795c_963c_687d_26fa,
            0x3d1d_960a_b3ba_d127,
            0x1c13_3110_54b3_00af,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x319b_ef54_9efe_dc8f,
            0xd247_5b37_5733_cb1e,
            0x195f_1302_cc68_9dc5,
            0x037a_f3e4_d8a5_d338,
        ]),
        pallas::Base::from_raw([
            0xff11_799a_7caa_d0fa,
            0x9e7b_7465_6565_12c3,
            0x0050_3e21_9155_0215,
            0x061f_c5d5_b4e6_7dd1,
        ]),
        pallas::Base::from_raw([
            0x2e47_4547_5bb8_d98d,
            0xee86_b745_5720_c619,
            0xe520_f782_00ea_b0b1,
            0x2e9d_62d7_87b4_ddd9,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x3664_22a8_a9fe_d3f1,
            0x5612_5771_9b44_b41f,
            0x9675_9a70_7813_7f7d,
            0x260b_46ed_156d_2ab0,
        ]),
        pallas::Base::from_raw([
            0xce6e_5ea4_9f6e_3e60,
            0x966c_c8c2_2a35_8012,
            0x86f8_9d31_140b_9246,
            0x0046_86cf_cd1f_9f1f,
        ]),
        pallas::Base::from_raw([
            0xbf4a_0139_570f_5744,
            0xb588_82d3_46b4_09a6,
            0xa686_5ccd_c93d_dc30,
            0x332e_deaa_8790_08c6,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0xe6cb_bc56_a1cc_0a00,
            0x07fe_d94c_329c_0b11,
            0xa554_6d21_e7df_e474,
            0x01ba_4b76_d0d0_8294,
        ]),
        pallas::Base::from_raw([
            0xe6db_8d3b_6045_5b92,
            0xf891_4a82_0dcc_8548,
            0x1c2e_ed71_8f99_49d5,
            0x2eac_3042_7fcf_4f55,
        ]),
        pallas::Base::from_raw([
            0x2c3d_ba81_95ee_2eee,
            0xfdd1_cc8b_a0e3_8bd0,
            0xbd95_1196_66e4_aa96,
            0x303c_32bf_49d7_3ea9,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0xcbd8_e21b_9841_fb66,
            0xc94b_0b35_69cf_7446,
            0xbb31_8107_12c3_fb08,
            0x0e1c_c1e0_2632_ef1a,
        ]),
        pallas::Base::from_raw([
            0x5caf_daf6_96e6_7e7e,
            0x4ba2_045e_3347_c610,
            0xba4f_c21b_5295_56cb,
            0x3305_1496_b670_beba,
        ]),
        pallas::Base::from_raw([
            0x65f9_0880_8b42_02f0,
            0x01e7_572a_ca00_e124,
            0x90a7_f444_31e2_17ea,
            0x0eab_a3f4_0a2c_53cd,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x8b02_bc51_ec68_a656,
            0xc96e_d1a3_c8ee_dc8c,
            0xd481_0b03_95cd_422a,
            0x0b01_e425_270e_c4f3,
        ]),
        pallas::Base::from_raw([
            0x7ebc_ffa2_b473_a674,
            0xfe84_48e7_d920_88c1,
            0x79ce_ca95_14f5_c4c3,
            0x133f_84bf_2658_6139,
        ]),
        pallas::Base::from_raw([
            0x7fe1_f95e_8b8c_3dd2,
            0x2739_e1e2_db9a_462a,
            0x1298_7260_f232_7ea0,
            0x3cbd_f49b_42e4_c2a5,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x3049_2c09_82eb_ed07,
            0xd633_96b1_6af9_a2ba,
            0x67db_3544_a2bf_6a17,
            0x2d38_b041_fc53_79cc,
        ]),
        pallas::Base::from_raw([
            0x7c09_1bfb_3d26_dd25,
            0xadfc_fee0_c8fa_c216,
            0x0be0_da12_998d_3bde,
            0x3ae6_480f_4501_54a6,
        ]),
        pallas::Base::from_raw([
            0x1057_9b58_eac5_2105,
            0x3066_e72b_b10b_4570,
            0x2a70_0564_1a6a_1d2d,
            0x01ac_e40f_2542_3f2c,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x2ef9_7c78_99c6_8028,
            0xb28c_e22d_6ad8_9993,
            0xfea2_b74b_a213_79cc,
            0x1212_fa56_5936_b14f,
        ]),
        pallas::Base::from_raw([
            0xfaae_2389_3d5f_50fd,
            0x9a0f_3029_72d3_b542,
            0x4627_f44f_183c_91e1,
            0x2166_389a_0e4e_1f36,
        ]),
        pallas::Base::from_raw([
            0xa3be_16b5_62d7_55c2,
            0x3857_6cf5_65d3_79e8,
            0x2c38_6d2d_f993_e845,
            0x0ade_42a7_91fe_f5cf,
        ]),
    ],
];
// Secure MDS: 0
// n: 255
// t: 3
// N: 765
// Result Algorithm 1:
//  [True, 0]
// Result Algorithm 2:
//  [True, None]
// Result Algorithm 3:
//  [True, None]
// Prime number: 0x40000000000000000000000000000000224698fc094cf91b992d30ed00000001
// MDS matrix:
const MDS: [[pallas::Base; 3]; 3] = [
    [
        pallas::Base::from_raw([
            0x5480_ad14_0416_5bb7,
            0xcec9_f152_75e1_51dd,
            0x2b2b_44a0_ae97_7970,
            0x2ceb_be12_17e1_2284,
        ]),
        pallas::Base::from_raw([
            0xdc65_5cba_595f_6be2,
            0x71a0_a9a8_5c2f_af79,
            0x0aa4_a254_996d_009a,
            0x3110_b59a_e4e8_14cf,
        ]),
        pallas::Base::from_raw([
            0x6a7e_dd65_fbe7_1f3a,
            0xccbd_6da8_a74d_d18a,
            0xf611_3fb1_e6f9_d58f,
            0x12e2_f071_4a5c_ca1d,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x60cf_aae4_ab4a_c980,
            0x1ef3_c5b7_712d_8a4d,
            0x8422_eaca_ccb4_e3cd,
            0x1058_43a5_52c0_f9b9,
        ]),
        pallas::Base::from_raw([
            0x853a_d5ef_4fc3_c705,
            0x0956_b654_1965_fc7e,
            0x4008_0459_729c_0a35,
            0x3ce8_7897_c427_fcea,
        ]),
        pallas::Base::from_raw([
            0x3185_2115_0218_4691,
            0x3d47_3e48_acfa_fc5a,
            0x8681_5443_67a1_4794,
            0x1d06_d6dd_c915_85c6,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0xc9ce_d954_a225_40b2,
            0x9e53_df43_3c9b_311d,
            0x0638_7e6a_3770_3091,
            0x2e73_a087_01c0_f7e9,
        ]),
        pallas::Base::from_raw([
            0x1240_f8d2_a183_d3d5,
            0xb21e_b75a_1f46_501c,
            0x3424_f185_565f_e5b4,
            0x3f25_0fa9_21f5_7698,
        ]),
        pallas::Base::from_raw([
            0xaa63_15cf_8d65_7550,
            0x989a_5940_2f58_1c3e,
            0xf318_f9d0_723b_e105,
            0x2f37_602c_d4d8_f52d,
        ]),
    ],
];

/// Generated by `halo2::primitives::poseidon::mds::generate_mds`.
const MDS_INV: [[pallas::Base; 3]; 3] = [
    [
        pallas::Base::from_raw([
            0x7df7_2e91_3ab5_b070,
            0x6b71_7e11_5a99_8237,
            0xfcde_6822_542b_6c27,
            0x14e2_b214_c3d1_26e9,
        ]),
        pallas::Base::from_raw([
            0x8976_b88c_4116_9a1b,
            0x15d8_c7e1_f126_efa5,
            0xb265_e1f4_a725_486d,
            0x29b6_6187_3828_1152,
        ]),
        pallas::Base::from_raw([
            0x85f0_c522_3085_e76c,
            0x780e_9758_ed23_76ef,
            0x2733_7f07_455b_a2d9,
            0x2d80_332b_403c_754e,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0x1c77_d7b8_05cd_4953,
            0xed0e_b256_719a_6edc,
            0xa636_c07c_ae76_0981,
            0x1b68_2ac8_0938_d3a3,
        ]),
        pallas::Base::from_raw([
            0xea73_ad09_fdba_59e1,
            0x4a50_6846_66f2_0539,
            0xf6cb_3f9b_29c3_9472,
            0x1cf1_2883_f098_6bcf,
        ]),
        pallas::Base::from_raw([
            0xf4b4_03db_1e05_7595,
            0x960e_c8be_4628_a1aa,
            0xb0b9_c36a_e1b0_7cc0,
            0x1513_897c_7c7e_3fc8,
        ]),
    ],
    [
        pallas::Base::from_raw([
            0xf3d7_d7b0_9fe3_6f8c,
            0x9526_6977_2ca1_d65b,
            0x3f24_dcd1_e80a_2fd3,
            0x0732_d96e_8001_b96e,
        ]),
        pallas::Base::from_raw([
            0x90f1_4247_7f07_c567,
            0x7df5_e253_1921_1a64,
            0x5e59_62b3_48a0_d694,
            0x3276_7b87_dd37_6aa5,
        ]),
        pallas::Base::from_raw([
            0x49cf_4c58_4659_39f7,
            0xeb8b_6ef6_5996_c0ca,
            0x709c_c68a_50e1_78b5,
            0x0ebf_6f0d_5431_e089,
        ]),
    ],
];

#[cfg(test)]
mod tests {
    use std::marker::PhantomData;

    use halo2::{arithmetic::FieldExt, pasta::pallas};

    use crate::primitives::poseidon::Spec;

    use super::{MDS, MDS_INV, ROUND_CONSTANTS};

    /// The same Poseidon specification as poseidon::OrchardNullifier, but constructed
    /// such that its constants will be generated at runtime.
    #[derive(Debug)]
    pub struct P128Pow5T3Plus<F: FieldExt> {
        secure_mds: usize,
        _field: PhantomData<F>,
    }

    impl<F: FieldExt> P128Pow5T3Plus<F> {
        pub fn new(secure_mds: usize) -> Self {
            P128Pow5T3Plus {
                secure_mds,
                _field: PhantomData::default(),
            }
        }
    }

    impl<F: FieldExt> Spec<F> for P128Pow5T3Plus<F> {
        type State = [F; 3];
        type Rate = [Option<F>; 2];

        fn width() -> usize {
            3
        }

        fn full_rounds() -> usize {
            8
        }

        fn partial_rounds() -> usize {
            58
        }

        fn sbox(val: F) -> F {
            val.pow_vartime(&[5])
        }

        fn secure_mds(&self) -> usize {
            self.secure_mds
        }
    }

    #[test]
    fn test_vectors() {
        let poseidon = P128Pow5T3Plus::<pallas::Base>::new(0);
        let (round_constants, mds, mds_inv) = poseidon.constants();

        for (actual, expected) in round_constants
            .iter()
            .flatten()
            .zip(ROUND_CONSTANTS.iter().flatten())
        {
            assert_eq!(actual, expected);
        }

        for (actual, expected) in mds.iter().flatten().zip(MDS.iter().flatten()) {
            assert_eq!(actual, expected);
        }

        for (actual, expected) in mds_inv.iter().flatten().zip(MDS_INV.iter().flatten()) {
            assert_eq!(actual, expected);
        }
    }
}
